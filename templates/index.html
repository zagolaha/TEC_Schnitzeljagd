{% extends "base.html" %}
{% block content %}
<div class="flex justify-center items-center absolute top-0 w-full h-1/12">
    <div id="time-bg" class="bg-Darkblue w-1/3 h-full text-center text-white rounded-b-lg">
        <p class="text-lg text-center font-semibold"><span id="time">00:00</span></p>
    </div>
</div>
<div class="flex flex-col img-bg w-screen h-screen bg-center bg-cover bg-no-repeat">
    <style>
        .img-bg {
            background-image: url("{{url_for('static', filename='raw_bg.png')}}");
        }
    </style>

    <div class="flex justify-center items-center w-full h-full">
        <div class="flex flex-col justify-center w-3/4 h-2/4 rounded-lg bg-black backdrop-blur-sm"
            style="background-color: rgba(0, 0, 0, 0.7);">
            <div class="flex justify-center items-center h-1/5 rounded-t-lg"
                style="background-color: rgba(0, 0, 0, 0.5);">
                <h3 class="text-white p-5 text-2xl">TEC-Schnitzeljagd</h3>
            </div>
            <div class="flex flex-col justify-center items-center text-center h-4/5">
                <div class="h-1/2 w-full flex justify-center items-center">
                    <p class="text-white text-xl">Suche im TEC nach versteckten QR-Codes, scanne sie und beantworte die
                        Fragen.</p>
                </div>
                <form action="{{ url_for('start') }}" class="h-1/2 w-full flex flex-col justify-center items-center"
                    id="start-form" method="post">
                    <input name="username" id="username_input"
                        class="bg-black shadow h-1/2 text-lg appearance-none border-2 rounded w-3/4 py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
                        type="text" placeholder="Benutzername">
                    <p class="text-sm" id="hint">&nbsp;</p>
                </form>
            </div>
        </div>
    </div>
    <div class="nav-btn-div">
        <button disabled id="start_use" onclick="redirectUser()" class="nav-btn">Starte die Reise</button>
    </div>
</div>
<script src="{{ url_for('static', filename='user-validation.js') }}"></script>
<script>
    var user_input = document.getElementById("username_input");

    user_input.addEventListener("keyup", function () {
        validateUser("{{ url_for('validUser') }}", user_input);
    });

    function startTimer() {
        localStorage.setItem("start_timer", "1");
        localStorage.setItem("start_time", Math.floor(Date.now() / 1000));
        var sec = parseInt("{{ max_sec }}");
        var min = parseInt("{{ max_min }}");
        var max_time = sec + (min * 60);
        localStorage.setItem("max_time", max_time);
    }

    function redirectUser() {
        if (localStorage.getItem("start_timer") == "0") {
            startTimer();
            document.getElementById("start-form").submit();
        }
    }
</script>
{% endblock %}